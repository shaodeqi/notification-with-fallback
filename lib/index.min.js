!function(o,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(o=o||self).WebNotification=n()}(this,function(){"use strict";function o(i,e){var t=this,o=e.fallbackForce,n=void 0!==o&&o,c=e.fallbackWhenDenied,a=void 0===c||c,u=e.focusOnClick,l=void 0===u||u,f=e.soundHack,d=void 0===f||f,s=e.pauseSoundOnClick,p=void 0!==s&&s,r=e.pauseSoundOnClose,k=void 0!==r&&r;d&&this._soundHack(e),"Notification"in window&&!n?Notification.requestPermission(function(o){if("granted"===o){t.isFallback=!1;var n=new Notification(i,e);n.onclick=function(){l&&window.focus(),p&&t.pauseSound(t.audio),"function"==typeof t.onclick&&t.onclick.apply(t,arguments)},"function"==typeof t.onclose&&(n.onclose=function(){k&&t.pauseSound(t.audio),"function"==typeof t.onclose&&t.onclose.apply(t,arguments)}),"function"==typeof t.onshow&&(n.onshow=t.onshow.bind(t)),"function"==typeof t.onerror&&(n.onerror=t.onerror.bind(t)),t.close=n.close.bind(n)}else"denied"===o?(t.isDenied=!0,a&&t._fallback(i,e)):t._fallback(i,e)}):this._fallback(i,e)}return o.prototype.close=function(){},o.prototype._soundHack=function(o){if(o.sound&&"Audio"in window){this.audio=new Audio(o.sound);var n=this.audio.play();void 0!==n&&n.catch(function(){}),delete o.sound}},o.prototype._fallback=function(o,n){this.isFallback=!0,"function"==typeof this.fallback&&this.fallback(o,n)},o.prototype.pauseSound=function(o){o&&o.pause&&(o.pause(),o=null)},o.prototype.fallback=function(n,i){var e=this,o=i.fallbackType,t=void 0===o?"confirm":o,c=i.fallbackTemplate,a=void 0===c?"title: body":c,u=i.fallbackDelay,l=void 0===u?1e3:u,f=i.pauseSoundOnClick,d=void 0!==f&&f,s=i.pauseSoundOnClose,p=void 0!==s&&s;setTimeout(function(){var o;o=a.replace(/title/g,n).replace(/body/g,i.body),e.onshow&&e.onshow(),("alert"===t?alert(o):confirm(o))?(d&&e.pauseSound(e.audio),"function"==typeof e.onclick&&e.onclick()):(p&&e.pauseSound(e.audio),"function"==typeof e.onclose&&e.onclose())},l)},o});
